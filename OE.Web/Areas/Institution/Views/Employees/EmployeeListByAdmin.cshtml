
@if (ViewBag.OeErrorMessage != null)
{
    @ViewBag.OeErrorMessage;
}
else
{
    @model OE.Web.Areas.Institution.Models.IndexEmployeeVM
    <h1 class="page-title">Employee List</h1>

    <div class="row">
        <div class="col-12 col-sm-6 col-md-3 pull-right">
            <form asp-area="Institution" asp-controller="Employees" asp-action="EmployeeListByAdmin" method="get">
                <select class="form-control" id="employeeStatus" name="employeeStatus" asp-items="@(new SelectList(new[] { new { Id = true, Value = "Current Employees" }, new { Id = false, Value = "Archive Employees" } }, "Id", "Value", Model.SelectedEmployee))" onchange="this.form.submit();"></select>
            </form>
        </div>
    </div>
    <br />
    
    <table class="table table-bordered table-hover" id="tblGetEmployees">
        <thead>
            <tr>
                <th>SN</th>
                <th>Employee</th>
                <th>Details</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @{var sn = 0; }
            @foreach (var data in Model.employeelist)
            {
                sn = (sn + 1);
                <tr>
                    <td><b>@sn</b></td>
                    <td class="showDetails pointer text-center">
                        @if (data.GenderId == 1)
                        {
                            <img id="IP300X200" src=@((String.IsNullOrEmpty(data.IP300X200)) ? "~/DataDictionary/images/defaultImages/GenderMale.png" : "~/" + data.IP300X200) asp-append-version="true" style="height:120px;width:120px;" />
                        }
                        else if (data.GenderId == 2)
                        {
                            <img id="IP300X200" src=@((String.IsNullOrEmpty(data.IP300X200)) ? "~/DataDictionary/images/defaultImages/GenderFemale.png" : "~/" + data.IP300X200) asp-append-version="true" style="height:120px;width:120px;" />
                        }
                        else if (data.GenderId == 3)
                        {
                            <img id="IP300X200" src=@((String.IsNullOrEmpty(data.IP300X200)) ? "~/DataDictionary/images/defaultImages/GenderThird.png" : "~/" + data.IP300X200) asp-append-version="true" style="height:120px;width:120px;" />
                        }

                        <div class="file">
                            <button id="btnViewOurEduPic" class="btn btn-primary" data-toggle="modal" data-target="#OurEduPhoto" data-img="@data.UsersIP300X200" style="margin-top:10px; background-color:transparent;  color:blue">
                                View Profile Picture
                            </button>
                        </div>
                    </td>
                    <td class="showDetails pointer">
                        <label> @data.FirstName @data.LastName</label><br />
                        <br />
                        @data.EmployeeTypeName
                        @if (!String.IsNullOrEmpty(data.EmployeeCategoryTypeName))
                        {
                            <text>(</text>
                            @data.EmployeeCategoryTypeName
                            <text>)</text>
                        }
                        <br />
                        OurEdu Id:<label style="background-color:yellow;">@data.UserLoginId</label><br />
                        Email: @data.EmailAddress <br />
                        Contact No: @data.ContactNo <br />
                        Joining Date:@data.JoiningDate.ToShortDateString() <br />
                    </td>

                    <td>
                        <a class="btn btn-primary btn-sm"
                           asp-area="Institution"
                           asp-controller="Employees"
                           asp-action="EmployeeDetailsByAdmin"
                           asp-route-empId="@data.Id">
                            <span class="glyphicon glyphicon-new-window" style="vertical-align:middle;margin-top: -5px"></span>
                            View Details
                        </a>
                        <button class="btn btn-danger btn-sm " id="btnDeleteempLists" data-toggle="modal" data-target="#modalDelete" data-id="@data.Id">
                            <span class="glyphicon glyphicon-trash" style="vertical-align:middle;margin-top: -5px"></span>
                            Delete
                        </button>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div id="modalDelete" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <div class="modal-content">
                <form enctype="multipart/form-data" id="empLists">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Confirm Message</h4>
                    </div>

                    <div class="modal-body">
                        <p><h3>Are you sure you want to delete this?</h3></p>
                    </div>
                    <div class="modal-footer">

                        <input type="hidden" name="empId" id="empId">

                        <button class="btn btn-md btn-success" id="btnDeleteEmploeesId" data-dismiss="modal">

                            <span class="glyphicon glyphicon-ok" style="vertical-align:middle;margin-top: -5px"></span>
                            Yes
                        </button>
                        
                        <button class="btn btn-danger btn-md " data-dismiss="modal">
                            <span class="glyphicon glyphicon-remove" style="vertical-align:middle; margin-top: -5px"></span>
                            No
                        </button>

                    </div>

                </form>

            </div>
        </div>
    </div>

    <div id="OurEduPhoto" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <h3 class="text-center">OurEdu Profile Picture</h3>
                <hr class="text-info" />
                <div class="modal-body">
                    <div class="text-center">

                        <img class="img-thumbnail img-responsive" id="oureduPic" alt="Image Not Available." />
                        <img class="img-thumbnail img-responsive " id="imgCommon" alt="Image Not Available." src="~/DataDictionary/images/defaultImages/Common.png" />


                    </div>
                    <hr />
                    <button class="btn btn-danger btn-md pull-right" data-dismiss="modal">
                        <span class="glyphicon glyphicon-remove" style="vertical-align:middle; margin-top: -5px"></span>
                        Cancel
                    </button>
                    <br />
                    <br />
                    <br />
                </div>
            </div>
        </div>
    </div>

      <div id="modalMessage" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Message</h4>
                </div>
                <div class="modal-body">
                    <p><h3 id="txtMessage" style="color:red"></h3></p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-danger btn-md " data-dismiss="modal">
                        <span class="glyphicon glyphicon-remove" style="vertical-align:middle; margin-top: -5px"></span>
                        Ok
                    </button>
                </div>

            </div>
        </div>
    </div>

}

<!-- #region "All Scripts" -->
@section Scripts
    {
    <script type="text/javascript">
            $('tr td #btnViewOurEduPic').on('click', function () {
                var imgLocation = $(this).data("img");
                if (imgLocation == "") {
                    $('#oureduPic').hide();
                    $('#imgCommon').show();
                } else {
                    var path = '/' + $(this).data("img");
                    $("#oureduPic").attr('src', path);
                    $('#imgCommon').hide();
                    $('#oureduPic').show();
                }
            });

            $('#tblGetEmployees tr td #btnDeleteempLists').on('click', function () {
                $("#empId").val($(this).data("id"));
            });
        
               
    $("#btnDeleteEmploeesId").on('click', function (e) {
                e.preventDefault();
                var Id = $('#empId').val();
        $.ajax({
                type: 'POST',
                data: { empId: Id },
                dataType: 'json',
                cache: false,
                url: '@Url.Action("DeleteEmpListByAdmin", "Employees", new { Area = "Institution" })',
            success: function (data) {
                if (data.success == true) {
                   location.reload();
                }
                if (data.success == false)
                {
                $('#txtMessage').text(data.message);
                $('#modalMessage').modal('show');
                }
                 },
            error: function (data) {
                 },
            complete: function () {
                 }
             });
        });


    </script>
}

<!-- #endregion  "All Scripts"-->
